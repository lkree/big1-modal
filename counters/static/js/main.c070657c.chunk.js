(this["webpackJsonpnew-counter-ts"]=this["webpackJsonpnew-counter-ts"]||[]).push([[0],{57:function(e,t,n){},83:function(e,t,n){},85:function(e,t,n){"use strict";n.r(t);var a,r,c,u=n(2),o=n(19),i=n.n(o),s=n(4),d=n(5),l=n(1),j=n(51),O=n(9);(r=a||(a={})).Single="single",r.Multi="multi",function(e){e[e.Playing=0]="Playing",e[e.Pause=1]="Pause"}(c||(c={}));var b,f={name:"\u0431\u0435\u0437 \u0438\u043c\u0435\u043d\u0438",state:c.Pause,renderValue:{seconds:0,minutes:0,hours:0},savedTime:0,startTime:null,intervalId:null},m={counters:{ids:[],data:{}},oldCounters:{ids:[],data:{}},mode:a.Multi,usedNames:[]},E=function(e){var t=e.startTime,n=e.savedTime,a=+new Date,r=Math.floor((a-t)/1e3)+n;return p(r)},v=function(e){return e.seconds+60*e.minutes+3600*e.hours},p=function(e){return{minutes:Math.floor(e/60%60),hours:Math.floor(e/3600),seconds:e%60}},x=function e(t){var n,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Array.isArray(t),c=t instanceof Date,u=_(t);if(c)return new Date(t);if(!a){if(r)return Object(j.a)(t);if(u)return Object(s.a)({},t)}return r||u?r?(n=[],t.forEach((function(t){return n.push(e(t,a))})),n):(n={},Object.keys(t).forEach((function(r){return n[r]=e(t[r],a)})),n):t},_=function(e){return"object"===typeof e&&!Array.isArray(e)&&null!==e&&!(e instanceof Date)},h=Object(l.createContext)([m,function(e){}]),T=n(87),y=n(88);!function(e){e.STOP="stop",e.PLAY="play",e.PAUSE="pause",e.UPDATE_TIME="updateTime",e.CREATE_COUNTER="createCounter",e.SET_INTERVAL_ID="setIntervalId",e.DELETE_AND_MOVE_TO_TABLE="deleteAndMoveToTable",e.CHANGE_NAME_FROM_EXIST="changeNameFromExist",e.CHANGE_NAME_FROM_DELETED="changeNameFromDeleted",e.DELETE_FROM_TABLE="deleteFromTable",e.CHANGE_MODE="changeMode",e.RESTORE_FROM_TABLE="restoreFromTable",e.ADD_TO_USED_NAMES="addToUsedNames",e.DELETE_FROM_USED_NAMES="deleteFromUsedNames",e.CHANGE_TIME="changeTime"}(b||(b={}));n(57);var N,g=function(e){var t=e.data,n=Object(l.useContext)(h),a=Object(d.a)(n,2)[1],r=t.id,c=t.name,o=t.renderValue,i=o.hours,s=o.minutes,j=o.seconds;return Object(u.jsxs)("div",{className:"oldCounterItem d-flex p-3 border-bottom align-items-center",children:[Object(u.jsx)("p",{className:"oldCounterItem__item text-white",children:Object(u.jsx)("input",{type:"text",className:"w-100 text-white",title:c,value:c,style:{background:"transparent",border:"none",textOverflow:"ellipsis"},onBlur:function(e){var t=e.target.value;return a({type:b.ADD_TO_USED_NAMES,payload:t})},onChange:function(e){return function(e,t){var n=e.target.value;return a({type:b.CHANGE_NAME_FROM_DELETED,id:t,payload:n})}(e,r)}})}),Object(u.jsxs)("p",{className:"oldCounterItem__item oldCounterItem__item--time text-white",children:[i," : ",s," : ",j]}),Object(u.jsx)("p",{className:"oldCounterItem__item oldCounterItem__item--action",onClick:function(){return function(e){return a({type:b.RESTORE_FROM_TABLE,id:e})}(r)},children:"\u2692"}),Object(u.jsx)("p",{className:"oldCounterItem__item oldCounterItem__item--action text-danger",onClick:function(){return function(e){return a({type:b.DELETE_FROM_TABLE,id:e})}(r)},children:"\xd7"})]})},C=n(86),A=function e(t){var n=t.name,a=t.data,r=Object(l.useState)(!1),c=Object(d.a)(r,2),o=c[0],i=c[1];return Object(u.jsxs)("div",{className:"bg-dark pt-1 pb-1 pl-3 pr-3",children:[Object(u.jsx)("div",{className:"text-white",onClick:function(e){e.stopPropagation(),i((function(e){return!e}))},children:n}),Object(u.jsx)(C.a,{isOpen:o,children:Object.keys(a).map((function(t){return a[t].isNode?Object(u.jsx)(g,{data:a[t]},t):Object(u.jsx)(e,{data:a[t],name:t},t)}))})]},n)},S=function(){var e=Object(l.useContext)(h),t=Object(d.a)(e,1)[0];if(!t.oldCounters.ids.length)return Object(u.jsx)(u.Fragment,{});var n=function(e){var t={};return e.oldCounters.ids.forEach((function(n){var a=new Date(+n),r=String(a.toLocaleString("default",{month:"long"})),c=String(a.getDate());t[r]||(t[r]={}),t[r][c]||(t[r][c]={}),t[r][c][n]=Object(s.a)(Object(s.a)({},e.oldCounters.data[n]),{},{id:n,isNode:!0})})),t}(t);return Object(u.jsx)(T.a,{className:"overflow-auto",children:Object(u.jsx)(y.a,{className:"mb-5",children:Object.keys(n).map((function(e){return Object(u.jsx)(A,{data:n[e],name:e},e)}))})})},D=n(91),M=n(48),I=function(){var e=Object(l.useContext)(h),t=Object(d.a)(e,2),n=t[0],a=t[1];return Object(u.jsx)(T.a,{children:Object(u.jsx)(y.a,{children:Object(u.jsx)(M.a,{onClick:function(){return a({type:b.CREATE_COUNTER})},children:n.counters.ids.length?"\u0415\u0449\u0451 \u0441\u0447\u0451\u0442\u0447\u0438\u043a":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0447\u0451\u0442\u0447\u0438\u043a"})})})},k=n(16),w=n(28),L=(N={},Object(O.a)(N,b.PLAY,(function(e,t){var n=t.id,r=t.startTime;return e.mode===a.Single&&e.counters.ids.forEach((function(t){e.counters.data[t]=Object(s.a)(Object(s.a)({},e.counters.data[t]),{},{state:c.Pause,savedTime:v(e.counters.data[t].renderValue),startTime:null}),null!==e.counters.data[t].intervalId&&(clearInterval(e.counters.data[t].intervalId),e.counters.data[t].intervalId=null)})),e.counters.data[n]=Object(s.a)(Object(s.a)({},e.counters.data[n]),{},{state:c.Playing,startTime:r}),e})),Object(O.a)(N,b.STOP,(function(e,t){var n,a=t.id;return clearInterval(null===(n=e.counters.data[a])||void 0===n?void 0:n.intervalId),e.counters.data[a]=Object(s.a)(Object(s.a)({},e.counters.data[a]),{},{startTime:null,state:c.Pause,intervalId:null,renderValue:f.renderValue,savedTime:f.savedTime}),e})),Object(O.a)(N,b.PAUSE,(function(e,t){var n=t.id;return clearInterval(e.counters.data[n].intervalId),e.counters.data[n]=Object(s.a)(Object(s.a)({},e.counters.data[n]),{},{startTime:null,state:c.Pause,intervalId:null,savedTime:v(e.counters.data[n].renderValue)}),e})),Object(O.a)(N,b.UPDATE_TIME,(function(e,t){var n=t.id;return e.counters.data[n].renderValue=E(e.counters.data[n]),e})),Object(O.a)(N,b.SET_INTERVAL_ID,(function(e,t){var n=t.id,a=t.intervalId;return e.counters.data[n].intervalId=a,e})),Object(O.a)(N,b.CREATE_COUNTER,(function(e){var t=String((new Date).getTime());return e.counters.ids.push(t),e.counters.data[t]=Object(s.a)({},f),e})),Object(O.a)(N,b.DELETE_AND_MOVE_TO_TABLE,(function(e,t){var n=t.id,a=e.counters.ids.filter((function(e){return e!==n})),r={},c=function(t){var a=t[n],c=Object(k.a)(t,[n].map(w.a)),u=null===a||void 0===a?void 0:a.renderValue,o=u.seconds,i=void 0===o?0:o,d=u.minutes,l=void 0===d?0:d,j=u.hours;return 0===i&&0===l&&0===(void 0===j?0:j)||(r=Object(s.a)({},a),e.oldCounters.ids.push(n)),c}(e.counters.data);return e.counters.data[n].intervalId&&clearInterval(e.counters.data[n].intervalId),e.oldCounters.data[n]=r,e.counters={ids:a,data:c},e})),Object(O.a)(N,b.CHANGE_NAME_FROM_EXIST,(function(e,t){var n=t.id,a=t.payload;return e.counters.data[n].name=a,e})),Object(O.a)(N,b.CHANGE_NAME_FROM_DELETED,(function(e,t){var n=t.id,a=t.payload;return e.oldCounters.data[n].name=a,e})),Object(O.a)(N,b.DELETE_FROM_TABLE,(function(e,t){var n=t.id;return e.oldCounters={ids:e.oldCounters.ids.filter((function(e){return n!==e})),data:function(e){e[n];return Object(k.a)(e,[n].map(w.a))}(e.oldCounters.data)},e})),Object(O.a)(N,b.CHANGE_MODE,(function(e,t){var n=t.mode;return n!==e.mode&&(e.mode=n),e})),Object(O.a)(N,b.RESTORE_FROM_TABLE,(function(e,t){var n=t.id,a=e.oldCounters.ids.filter((function(e){return e!==n})),r={},c=function(t){var a=t[n],c=Object(k.a)(t,[n].map(w.a));return r=Object(s.a)({},a),e.counters.ids.push(n),c}(e.oldCounters.data);return e.oldCounters={ids:a,data:c},e.counters.data[n]=r,e})),Object(O.a)(N,b.ADD_TO_USED_NAMES,(function(e,t){var n=t.payload.trim().toLowerCase();return n&&e.usedNames.every((function(e){return!~e.indexOf(n)}))&&!e.usedNames.includes(n)&&e.usedNames.push(n),e})),Object(O.a)(N,b.DELETE_FROM_USED_NAMES,(function(e,t){var n=t.payload;return e.usedNames=e.usedNames.filter((function(e){return e!==n})),e})),Object(O.a)(N,b.CHANGE_TIME,(function(e,t){var n=t.payload,a=t.timeType,r=t.id;return e.counters.data[r].renderValue[a]=+n,e.counters.data[r].savedTime=function(e,t,n){return v(Object(s.a)(Object(s.a)({},e),{},Object(O.a)({},t,n)))}(e.counters.data[r].renderValue,a,+n),e})),N),R=Object(O.a)({},b.UPDATE_TIME,(function(e,t){var n=t.id;return e.counters.data[n]=Object(s.a)(Object(s.a)({},e.counters.data[n]),{},{renderValue:E(e.counters.data[n]),state:c.Pause,savedTime:v(e.counters.data[n].renderValue)+1}),e})),P=function(e,t){var n=L[t.type](x(e,!0),t);return t.setStorageState(t.type in R?R[t.type](x(e,!0),t):n),n||x(n)},F=n(89),U=n(92),V=n(93),H=n(90),B=function(){var e=Object(l.useContext)(h),t=Object(d.a)(e,2),n=t[0],r=t[1],c=Object(l.useState)(!1),o=Object(d.a)(c,2),i=o[0],s=o[1];return Object(u.jsx)("div",{style:{position:"absolute",top:"10px",right:"15px"},children:Object(u.jsxs)(F.a,{isOpen:i,toggle:function(){return s((function(e){return!e}))},children:[Object(u.jsx)(U.a,{caret:!0,children:n.mode}),Object(u.jsxs)(V.a,{container:"body",children:[Object(u.jsx)(H.a,{onClick:function(){return r({type:b.CHANGE_MODE,mode:a.Single})},children:a.Single}),Object(u.jsx)(H.a,{onClick:function(){return r({type:b.CHANGE_MODE,mode:a.Multi})},children:a.Multi})]})]})})},G=(n(83),function(e){var t=e.currentInput,n=e.onClick,a=e.onDelete,r=e.onKeyDown,c=Object(l.useContext)(h),o=Object(d.a)(c,1)[0],i=Object(l.useCallback)((function(){return o.usedNames.filter((function(e){return~e.indexOf(t.toLowerCase())&&t!==e}))}),[o.usedNames,t]),s=Object(l.useState)(null),j=Object(d.a)(s,2),O=j[0],b=j[1],f=Object(l.useState)(i()),m=Object(d.a)(f,2),E=m[0],v=m[1],p=Object(l.useCallback)((function(e){var t="ArrowDown"===e.key,a="ArrowUp"===e.key,c="Enter"===e.key;if(t||a)return r(O),b((function(e){var n=E.length-1;return null===e||0===e&&a?0:e>=n&&t?n:e+(t?1:-1)}));c&&null!==O&&n(E[O]),b(null),r(null)}),[r,n,E,O]);return Object(l.useEffect)((function(){return v(i)}),[i]),Object(l.useEffect)((function(){return document.addEventListener("keydown",p)})),Object(l.useEffect)((function(){return function(){return document.removeEventListener("keydown",p)}})),E.length?Object(u.jsx)("div",{className:"inputHelper bg-white d-flex flex-column position-absolute p-1",style:{top:"70px",zIndex:10},children:E.map((function(e,t){return Object(u.jsxs)("div",{className:"inputHelper__item"+(O===t?" bg-warning":""),children:[Object(u.jsx)("p",{className:"inputHelper__text",onClick:function(t){t.stopPropagation(),n(e)},children:e}),Object(u.jsx)("div",{onClick:function(t){t.stopPropagation(),a(e)},className:"inputHelper__item-delete text-danger",children:"\xd7"})]},e)}))}):Object(u.jsx)(u.Fragment,{})}),J="text-white d-flex text-white bg-dark align-items-center justify-content-center text-center",z={border:"none",width:"30%",height:"24px",padding:0},K=function(e){var t=e.isEdit,n=e.value,a=Object(k.a)(e,["isEdit","value"]);return t?Object(u.jsx)("input",Object(s.a)({value:n,className:J,style:z},a)):Object(u.jsx)("div",Object(s.a)(Object(s.a)({},a),{},{className:J,style:Object(s.a)(Object(s.a)({},z),{},{cursor:"default"}),children:n}))},X=function(e){var t=e.style,n=Object(k.a)(e,["style"]);return Object(u.jsx)(M.a,Object(s.a)({className:"bg-dark p-0 position-absolute",style:Object(s.a)({width:"15px",height:"15px"},t)},n))},Y=["hours","minutes","seconds"],q=function(e){var t=e.id,n=Object(l.useRef)(null),a=Object(l.useState)(""),r=Object(d.a)(a,2),o=r[0],i=r[1],s=Object(l.useState)(!1),j=Object(d.a)(s,2),O=j[0],f=j[1],m=Object(l.useContext)(h),E=Object(d.a)(m,2),v=E[0],p=E[1],x=Object(l.useState)(!1),_=Object(d.a)(x,2),T=_[0],y=_[1],N=Object(l.useState)(!1),g=Object(d.a)(N,2),C=g[0],A=g[1],S=Object(l.useState)(!0),D=Object(d.a)(S,2),I=D[0],k=D[1],w=function(){return v.counters.data[t].state===c.Playing},L=function(e){var n=e.target.value;f(Boolean(n)),i(n),p({type:b.CHANGE_NAME_FROM_EXIST,payload:n,id:t})},R=v.counters.data[t],P=R.name,F=R.savedTime;return Object(u.jsxs)("div",{style:{border:"1px solid"},className:"d-flex flex-column position-relative pt-4 pb-4 bg-dark",children:[Object(u.jsx)("div",{className:"position-absolute text-danger",style:{top:"-5px",right:"5px",fontSize:"20px",cursor:"pointer"},onClick:function(){return p({type:b.DELETE_AND_MOVE_TO_TABLE,id:t})},children:"\xd7"}),Object(u.jsx)("div",{className:"position-absolute ".concat(T?"badge-danger":""," "),style:{top:"5px",right:"25px",fontSize:"10px",cursor:"pointer"},onClick:function(){y((function(e){return!e})),A((function(e){return!e}))},children:"\u270e"}),0!==F&&Object(u.jsx)(X,{style:{top:"5px",left:"5px"},onClick:function(){return p({type:b.STOP,id:t})}}),Object(u.jsx)("input",{className:"mb-3 mt-3 align-self-center text-white bg-dark",style:{maxWidth:"60%",border:"transparent"},value:P,title:P,ref:n,onKeyDown:function(e){return O&&!I&&e.preventDefault()},onBlur:function(e){var t=e.target.value;setTimeout((function(){return f(!1)}),300),C||y(!1),p({type:b.ADD_TO_USED_NAMES,payload:t})},onFocus:function(){return e=P,y(!0),f(Boolean(e)),void i(e);var e},onChange:L}),O&&Object(u.jsx)(G,{currentInput:o,onClick:function(e){L({target:{value:e}}),n.current.focus()},onDelete:function(e){setTimeout((function(){n.current.focus(),f(!0)}),300),p({type:b.DELETE_FROM_USED_NAMES,payload:e})},onKeyDown:function(e){return k(null===e)}}),Object(u.jsx)("div",{className:"mb-5 justify-content-around d-flex text-white w-100",children:function(){var e=v.counters.data[t].renderValue,n=e.seconds,a=e.minutes;return[e.hours,a,n].map((function(e,n){return Object(u.jsx)(K,{isEdit:T,value:e,onChange:function(e){var a,r,c=e.target.value;return a=c,r=Y[n],void(T&&isFinite(+a)&&p({type:b.CHANGE_TIME,payload:a,timeType:r,id:t}))}},Y[n])}))}()}),Object(u.jsx)("div",{className:"justify-content-around d-flex",children:Object(u.jsx)(M.a,{color:"success",onClick:function(){if(w())return p({type:b.PAUSE,id:t});p({type:b.PLAY,id:t,startTime:+new Date});var e=setInterval((function(){return p({type:b.UPDATE_TIME,id:t})}),1e3);p({type:b.SET_INTERVAL_ID,intervalId:e,id:t})},style:{flexBasis:"80%"},children:w()?"\u041f\u0430\u0443\u0437\u0430":0===F?"\u0421\u0442\u0430\u0440\u0442":"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c"})})]})},W=function(){var e=Object(l.useContext)(h),t=Object(d.a)(e,1)[0];return Object(u.jsx)(T.a,{className:"mb-4",children:t.counters.ids.map((function(e){return Object(u.jsx)(y.a,{md:4,className:"mb-4",children:Object(u.jsx)(q,{id:e})},e)}))},"counters")},Q=function(){var e=function(e){var t=e.keys,n=e.initialState,a=void 0===n?{}:n,r={};Object.keys(a).forEach((function(e){return localStorage.setItem(e,JSON.stringify(a[e]))})),t.forEach((function(e){var t=JSON.parse(localStorage.getItem(e));["counters","oldCounters"].includes(e)&&(null===t||void 0===t||t.ids.forEach((function(e){t.data[e].value&&(t.data[e]=Object(s.a)(Object(s.a)({},t.data[e]),{},{renderValue:Object(s.a)({},t.data[e].value)}),delete t.data[e].value)}))),null!==t&&void 0!==t&&(r[e]=t)}));var c=Object(l.useState)(r),u=Object(d.a)(c,2),o=u[0],i=u[1];return[o,function(e){var n;n="function"===typeof e?Object(s.a)(Object(s.a)({},o),e(o)):Object(s.a)(Object(s.a)({},o),e),t.forEach((function(e){return localStorage.setItem(e,JSON.stringify(n[e]))})),i(n)}]}({keys:Object.keys(m)}),t=Object(d.a)(e,2),n=t[0],a=t[1],r=Object(l.useReducer)(P,Object(s.a)(Object(s.a)({},m),n)),c=Object(d.a)(r,2),o=c[0],i=c[1];return Object(u.jsx)(h.Provider,{value:[o,function(e){return i(Object(s.a)(Object(s.a)({},e),{},{setStorageState:a}))}],children:Object(u.jsxs)(D.a,{fluid:!0,className:"bg-primary",style:{minHeight:"100vh",padding:"70px 3rem 20px"},children:[Object(u.jsx)(B,{}),Object(u.jsx)(S,{}),Object(u.jsx)(W,{}),Object(u.jsx)(I,{})]})})};n(84);i.a.render(Object(u.jsx)(Q,{}),document.querySelector("#root"))}},[[85,1,2]]]);
//# sourceMappingURL=main.c070657c.chunk.js.map