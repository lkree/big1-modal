(this["webpackJsonpnew-counter-ts"]=this["webpackJsonpnew-counter-ts"]||[]).push([[0],{57:function(e,t,a){},83:function(e,t,a){},85:function(e,t,a){"use strict";a.r(t);var c,n=a(4),r=a(18),s=a.n(r),o=a(1),i=a(5),u=a(2);!function(e){e[e.Playing=0]="Playing",e[e.Pause=1]="Pause"}(c||(c={}));var d,j,O={name:"\u0431\u0435\u0437 \u0438\u043c\u0435\u043d\u0438",state:c.Pause,value:{seconds:0,minutes:0,hours:0},intervalId:null};(j=d||(d={})).Single="single",j.Multi="multi";var l,b={counters:{ids:[],data:{}},oldCounters:{ids:[],data:{}},mode:d.Multi,usedNames:[]},E=function(e){var t=e.seconds+1,a=e.minutes,c=e.hours;return 60===t&&(t=0,a+=1),60===a&&(a=0,c+=1),{seconds:t,minutes:a,hours:c}},m=Object(u.createContext)([b,function(e){}]),f=a(87),p=a(88);!function(e){e.STOP="stop",e.PLAY="play",e.PAUSE="pause",e.UPDATE_TIME="updateTime",e.CREATE_COUNTER="createCounter",e.SET_INTERVAL_ID="setIntervalId",e.DELETE_AND_MOVE_TO_TABLE="deleteAndMoveToTable",e.CHANGE_NAME_FROM_EXIST="changeNameFromExist",e.CHANGE_NAME_FROM_DELETED="changeNameFromDeleted",e.DELETE_FROM_TABLE="deleteFromTable",e.CHANGE_MODE="changeMode",e.RESTORE_FROM_TABLE="restoreFromTable",e.ADD_TO_USED_NAMES="addToUsedNames",e.DELETE_FROM_USED_NAMES="deleteFromUsedNames"}(l||(l={}));a(57);var _=function(e){var t=e.data,a=Object(u.useContext)(m),c=Object(i.a)(a,2)[1],r=t.id,s=t.name,o=t.value,d=o.hours,j=o.minutes,O=o.seconds;return Object(n.jsxs)("div",{className:"oldCounterItem d-flex p-3 border-bottom align-items-center",children:[Object(n.jsx)("p",{className:"oldCounterItem__item text-white",children:Object(n.jsx)("input",{type:"text",className:"w-100 text-white",title:s,value:s,style:{background:"transparent",border:"none",textOverflow:"ellipsis"},onBlur:function(e){var t=e.target.value;return c({type:l.ADD_TO_USED_NAMES,payload:t})},onChange:function(e){return function(e,t){var a=e.target.value;return c({type:l.CHANGE_NAME_FROM_DELETED,id:t,payload:a})}(e,r)}})}),Object(n.jsxs)("p",{className:"oldCounterItem__item oldCounterItem__item--time text-white",children:[d," : ",j," : ",O]}),Object(n.jsx)("p",{className:"oldCounterItem__item oldCounterItem__item--action",onClick:function(){return function(e){return c({type:l.RESTORE_FROM_TABLE,id:e})}(r)},children:"\u2692"}),Object(n.jsx)("p",{className:"oldCounterItem__item oldCounterItem__item--action text-danger",onClick:function(){return function(e){return c({type:l.DELETE_FROM_TABLE,id:e})}(r)},children:"\xd7"})]})},v=a(86),x=function e(t){var a=t.name,c=t.data,r=Object(u.useState)(!1),s=Object(i.a)(r,2),o=s[0],d=s[1];return Object(n.jsxs)("div",{className:"bg-dark pt-1 pb-1 pl-3 pr-3",children:[Object(n.jsx)("div",{className:"text-white",onClick:function(e){e.stopPropagation(),d((function(e){return!e}))},children:a}),Object(n.jsx)(v.a,{isOpen:o,children:Object.keys(c).map((function(t){return c[t].isNode?Object(n.jsx)(_,{data:c[t]},t):Object(n.jsx)(e,{data:c[t],name:t},t)}))})]},a)},h=function(){var e=Object(u.useContext)(m),t=Object(i.a)(e,1)[0],a={};return t.oldCounters.ids.forEach((function(e){var c=new Date(+e),n=String(c.toLocaleString("default",{month:"long"})),r=String(c.getDate());a[n]||(a[n]={}),a[n][r]||(a[n][r]={}),a[n][r][e]=Object(o.a)(Object(o.a)({},t.oldCounters.data[e]),{},{id:e,isNode:!0})})),t.oldCounters.ids.length?Object(n.jsx)(f.a,{className:"overflow-auto",children:Object(n.jsx)(p.a,{className:"mb-5",children:Object.keys(a).map((function(e){return Object(n.jsx)(x,{data:a[e],name:e},e)}))})}):Object(n.jsx)(n.Fragment,{})},S=a(91),N=a(48),C=function(){var e=Object(u.useContext)(m),t=Object(i.a)(e,2),a=t[0],c=t[1];return Object(n.jsx)(f.a,{children:Object(n.jsx)(p.a,{children:Object(n.jsx)(N.a,{onClick:function(){return c({type:l.CREATE_COUNTER})},children:a.counters.ids.length?"\u0415\u0449\u0451 \u0441\u0447\u0451\u0442\u0447\u0438\u043a":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0447\u0451\u0442\u0447\u0438\u043a"})})})},g=a(51),T=a(28),y=a(27),A=a(12),D=function(e,t){var a;switch(t.type){case l.STOP:return e.counters.data[t.id].state===c.Playing&&clearInterval(e.counters.data[t.id].intervalId),Object(o.a)(Object(o.a)({},e),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(A.a)({},t.id,Object(o.a)(Object(o.a)({},e.counters.data[t.id]),{},{state:c.Pause,value:O.value})))})});case l.PLAY:if(e.mode===d.Single){var n={};return e.counters.ids.forEach((function(t){n[t]=Object(o.a)(Object(o.a)({},e.counters.data[t]),{},{state:c.Pause}),null!==n[t].intervalId&&(clearInterval(n[t].intervalId),n[t].intervalId=null)})),Object(o.a)(Object(o.a)({},e),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},n),{},Object(A.a)({},t.id,Object(o.a)(Object(o.a)({},e.counters.data[t.id]),{},{state:c.Playing})))})})}return Object(o.a)(Object(o.a)({},e),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(A.a)({},t.id,Object(o.a)(Object(o.a)({},e.counters.data[t.id]),{},{state:c.Playing})))})});case l.PAUSE:return clearInterval(e.counters.data[t.id].intervalId),Object(o.a)(Object(o.a)({},e),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(A.a)({},t.id,Object(o.a)(Object(o.a)({},e.counters.data[t.id]),{},{state:c.Pause})))})});case l.UPDATE_TIME:return a=Object(o.a)(Object(o.a)({},e),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(A.a)({},t.id,Object(o.a)(Object(o.a)({},e.counters.data[t.id]),{},{value:E(e.counters.data[t.id].value)})))})}),t.setStorageState(Object(o.a)(Object(o.a)({},a),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(A.a)({},t.id,Object(o.a)(Object(o.a)({},e.counters.data[t.id]),{},{state:c.Pause})))})})),a;case l.SET_INTERVAL_ID:return a=Object(o.a)(Object(o.a)({},e),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(A.a)({},t.id,Object(o.a)(Object(o.a)({},e.counters.data[t.id]),{},{intervalId:t.intervalId})))})}),t.setStorageState(a),a;case l.CREATE_COUNTER:var r=String((new Date).getTime());return e.counters.ids.push(r),a=Object(o.a)(Object(o.a)({},e),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(A.a)({},r,Object(o.a)({},O)))})}),t.setStorageState(a),a;case l.DELETE_AND_MOVE_TO_TABLE:var s=e.counters.ids.filter((function(e){return e!==t.id})),i={},u=function(a){var c=t.id,n=a[c],r=Object(T.a)(a,[c].map(y.a)),s=null===n||void 0===n?void 0:n.value,u=s.seconds,d=void 0===u?0:u,j=s.minutes,O=void 0===j?0:j,l=s.hours;return 0===d&&0===O&&0===(void 0===l?0:l)||(i=Object(o.a)({},n),e.oldCounters.ids.push(t.id)),r}(e.counters.data);return e.counters.data[t.id].intervalId&&clearInterval(e.counters.data[t.id].intervalId),a=Object(o.a)(Object(o.a)({},e),{},{oldCounters:Object(o.a)(Object(o.a)({},e.oldCounters),{},{data:Object(o.a)(Object(o.a)({},e.oldCounters.data),{},Object(A.a)({},t.id,i))}),counters:{ids:s,data:u}}),t.setStorageState(a),a;case l.CHANGE_NAME_FROM_EXIST:return a=Object(o.a)(Object(o.a)({},e),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(A.a)({},t.id,Object(o.a)(Object(o.a)({},e.counters.data[t.id]),{},{name:t.payload})))})}),t.setStorageState(a),a;case l.CHANGE_NAME_FROM_DELETED:return a=Object(o.a)(Object(o.a)({},e),{},{oldCounters:Object(o.a)(Object(o.a)({},e.oldCounters),{},{data:Object(o.a)(Object(o.a)({},e.oldCounters.data),{},Object(A.a)({},t.id,Object(o.a)(Object(o.a)({},e.oldCounters.data[t.id]),{},{name:t.payload})))})}),t.setStorageState(a),a;case l.DELETE_FROM_TABLE:var j=function(e){var a=t.id;e[a];return Object(T.a)(e,[a].map(y.a))}(e.oldCounters.data),b=e.oldCounters.ids.filter((function(e){return t.id!==e}));return a=Object(o.a)(Object(o.a)({},e),{},{oldCounters:{ids:b,data:j}}),t.setStorageState(a),a;case l.CHANGE_MODE:return t.mode!==e.mode?(a=Object(o.a)(Object(o.a)({},e),{},{mode:t.mode}),t.setStorageState(a),a):Object(o.a)({},e);case l.RESTORE_FROM_TABLE:var m=e.oldCounters.ids.filter((function(e){return e!==t.id})),f={},p=function(a){var c=t.id,n=a[c],r=Object(T.a)(a,[c].map(y.a));return f=Object(o.a)({},n),e.counters.ids.push(t.id),r}(e.oldCounters.data);return a=Object(o.a)(Object(o.a)({},e),{},{oldCounters:{ids:m,data:Object(o.a)({},p)},counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(A.a)({},t.id,f))})}),t.setStorageState(a),a;case l.ADD_TO_USED_NAMES:var _=t.payload.trim().toLowerCase();return _&&e.usedNames.every((function(e){return!~e.indexOf(_)}))?(a=Object(o.a)(Object(o.a)({},e),!e.usedNames.includes(_)&&{usedNames:[].concat(Object(g.a)(e.usedNames),[_])}),t.setStorageState(a),Object(o.a)({},a)):Object(o.a)({},e);case l.DELETE_FROM_USED_NAMES:return a=Object(o.a)(Object(o.a)({},e),{},{usedNames:e.usedNames.filter((function(e){return e!==t.payload}))}),t.setStorageState(a),Object(o.a)({},a);default:return Object(o.a)({},e)}},I=a(89),M=a(92),R=a(93),L=a(90),P=function(){var e=Object(u.useContext)(m),t=Object(i.a)(e,2),a=t[0],c=t[1],r=Object(u.useState)(!1),s=Object(i.a)(r,2),o=s[0],j=s[1];return Object(n.jsx)("div",{style:{position:"absolute",top:"10px",right:"15px"},children:Object(n.jsxs)(I.a,{isOpen:o,toggle:function(){return j((function(e){return!e}))},children:[Object(n.jsx)(M.a,{caret:!0,children:a.mode}),Object(n.jsxs)(R.a,{container:"body",children:[Object(n.jsx)(L.a,{onClick:function(){return c({type:l.CHANGE_MODE,mode:d.Single})},children:d.Single}),Object(n.jsx)(L.a,{onClick:function(){return c({type:l.CHANGE_MODE,mode:d.Multi})},children:d.Multi})]})]})})},k=(a(83),function(e){var t=e.currentInput,a=e.onClick,c=e.onDelete,r=Object(u.useContext)(m),s=Object(i.a)(r,1)[0];return Object(n.jsx)("div",{className:"inputHelper bg-white d-flex flex-column position-absolute",style:{top:"70px",zIndex:10},children:s.usedNames.filter((function(e){return~e.indexOf(t.toLowerCase())&&t!==e})).map((function(e){return Object(n.jsxs)("div",{className:"inputHelper__item",children:[Object(n.jsx)("p",{className:"inputHelper__text",onClick:function(t){t.stopPropagation(),a(e)},children:e}),Object(n.jsx)("div",{onClick:function(t){t.stopPropagation(),c(e)},className:"inputHelper__item-delete text-danger",children:"\xd7"})]},e)}))})}),F=function(e){var t=e.id,a=Object(u.useRef)(null),r=Object(u.useState)(""),s=Object(i.a)(r,2),o=s[0],d=s[1],j=Object(u.useState)(!1),O=Object(i.a)(j,2),b=O[0],E=O[1],f=Object(u.useContext)(m),p=Object(i.a)(f,2),_=p[0],v=p[1],x=function(){return _.counters.data[t].state===c.Playing},h=function(e){var a=e.target.value;E(Boolean(a)),d(a),v({type:l.CHANGE_NAME_FROM_EXIST,payload:a,id:t})},S=_.counters.data[t],C=S.value,g=C.hours,T=C.minutes,y=C.seconds,A=S.name;return Object(n.jsxs)("div",{style:{border:"1px solid"},className:"d-flex flex-column position-relative pt-4 pb-4 bg-dark",children:[Object(n.jsx)("div",{className:"position-absolute text-danger",style:{top:"-5px",right:"5px",fontSize:"20px",cursor:"pointer"},onClick:function(){return v({type:l.DELETE_AND_MOVE_TO_TABLE,id:t})},children:"\xd7"}),Object(n.jsx)("input",{className:"mb-3 mt-3 align-self-center text-white bg-dark",style:{maxWidth:"60%",border:"transparent"},value:A,title:A,ref:a,onBlur:function(e){var t=e.target.value;setTimeout((function(){return E(!1)}),300),v({type:l.ADD_TO_USED_NAMES,payload:t})},onFocus:function(){return e=A,E(Boolean(e)),void d(e);var e},onChange:h}),b&&Object(n.jsx)(k,{currentInput:o,onClick:function(e){h({target:{value:e}}),a.current.focus()},onDelete:function(e){setTimeout((function(){a.current.focus(),E(!0)}),300),v({type:l.DELETE_FROM_USED_NAMES,payload:e})}}),Object(n.jsxs)("div",{className:"mb-5 justify-content-around d-flex",children:[Object(n.jsxs)("div",{className:"text-white",children:[g," :"]}),Object(n.jsxs)("div",{className:"text-white",children:[T," :"]}),Object(n.jsx)("div",{className:"text-white",children:y})]}),Object(n.jsxs)("div",{className:"justify-content-around d-flex",children:[Object(n.jsx)(N.a,{color:"success",onClick:function(){if(x())v({type:l.PAUSE,id:t});else{v({type:l.PLAY,id:t});var e=setInterval((function(){return v({type:l.UPDATE_TIME,id:t})}),1e3);v({type:l.SET_INTERVAL_ID,intervalId:e,id:t})}},style:{flexBasis:"40%"},children:x()?"\u041f\u0430\u0443\u0437\u0430":0===y?"\u0421\u0442\u0430\u0440\u0442":"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c"}),!x()&&Object(n.jsx)(N.a,{color:"success",style:{flexBasis:"40%"},onClick:function(){return v({type:l.STOP,id:t})},children:"\u0421\u0442\u043e\u043f"})]})]})},w=function(){var e=Object(u.useContext)(m),t=Object(i.a)(e,1)[0];return Object(n.jsx)(f.a,{className:"mb-4",children:t.counters.ids.map((function(e){return Object(n.jsx)(p.a,{md:4,className:"mb-4",children:Object(n.jsx)(F,{id:e})},e)}))},"counters")},U=function(){var e=function(e){var t=e.keys,a=e.initialState,c=void 0===a?{}:a,n={};Object.keys(c).forEach((function(e){localStorage.setItem(e,JSON.stringify(c[e]))})),t.forEach((function(e){var t=JSON.parse(localStorage.getItem(e));null!==t&&void 0!==t&&(n[e]=t)}));var r=Object(u.useState)(n),s=Object(i.a)(r,2),d=s[0],j=s[1];return[d,function(e){var a;a="function"===typeof e?Object(o.a)(Object(o.a)({},d),e(d)):Object(o.a)(Object(o.a)({},d),e),t.forEach((function(e){return localStorage.setItem(e,JSON.stringify(a[e]))})),j(a)}]}({keys:Object.keys(b)}),t=Object(i.a)(e,2),a=t[0],c=t[1],r=Object(u.useReducer)(D,Object(o.a)(Object(o.a)({},b),a)),s=Object(i.a)(r,2),d=s[0],j=s[1];return Object(n.jsx)(m.Provider,{value:[d,function(e){return j(Object(o.a)(Object(o.a)({},e),{},{setStorageState:c}))}],children:Object(n.jsxs)(S.a,{fluid:!0,className:"bg-primary",style:{minHeight:"100vh",padding:"70px 3rem 20px"},children:[Object(n.jsx)(P,{}),Object(n.jsx)(h,{},"oldCounters"),Object(n.jsx)(w,{}),Object(n.jsx)(C,{},"createCounter")]})})};a(84);s.a.render(Object(n.jsx)(U,{}),document.querySelector("#root"))}},[[85,1,2]]]);
//# sourceMappingURL=main.dbf53f28.chunk.js.map