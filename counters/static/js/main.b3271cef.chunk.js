(this["webpackJsonpnew-counter-ts"]=this["webpackJsonpnew-counter-ts"]||[]).push([[0],{57:function(e,t,a){},83:function(e,t,a){},85:function(e,t,a){"use strict";a.r(t);var n,c=a(4),r=a(18),s=a.n(r),o=a(0),u=a(5),i=a(2),d=a(10);!function(e){e[e.Playing=0]="Playing",e[e.Pause=1]="Pause"}(n||(n={}));var l,j,O={name:"\u0431\u0435\u0437 \u0438\u043c\u0435\u043d\u0438",state:n.Pause,renderValue:{seconds:0,minutes:0,hours:0},savedTime:0,startTime:null,intervalId:null};(j=l||(l={})).Single="single",j.Multi="multi";var b,m={counters:{ids:[],data:{}},oldCounters:{ids:[],data:{}},mode:l.Multi,usedNames:[]},E=function(e){return e.seconds+60*e.minutes+3600*e.hours},f=function(e){return{minutes:Math.floor(e/60%60),hours:Math.floor(e/3600),seconds:e%60}},p=function(e,t,a){return E(Object(o.a)(Object(o.a)({},e),{},Object(d.a)({},t,a)))},x=Object(i.createContext)([m,function(e){}]),v=a(87),_=a(88);!function(e){e.STOP="stop",e.PLAY="play",e.PAUSE="pause",e.UPDATE_TIME="updateTime",e.CREATE_COUNTER="createCounter",e.SET_INTERVAL_ID="setIntervalId",e.DELETE_AND_MOVE_TO_TABLE="deleteAndMoveToTable",e.CHANGE_NAME_FROM_EXIST="changeNameFromExist",e.CHANGE_NAME_FROM_DELETED="changeNameFromDeleted",e.DELETE_FROM_TABLE="deleteFromTable",e.CHANGE_MODE="changeMode",e.RESTORE_FROM_TABLE="restoreFromTable",e.ADD_TO_USED_NAMES="addToUsedNames",e.DELETE_FROM_USED_NAMES="deleteFromUsedNames",e.CHANGE_TIME="changeTime"}(b||(b={}));a(57);var h=function(e){var t=e.data,a=Object(i.useContext)(x),n=Object(u.a)(a,2)[1],r=t.id,s=t.name,o=t.renderValue,d=o.hours,l=o.minutes,j=o.seconds;return Object(c.jsxs)("div",{className:"oldCounterItem d-flex p-3 border-bottom align-items-center",children:[Object(c.jsx)("p",{className:"oldCounterItem__item text-white",children:Object(c.jsx)("input",{type:"text",className:"w-100 text-white",title:s,value:s,style:{background:"transparent",border:"none",textOverflow:"ellipsis"},onBlur:function(e){var t=e.target.value;return n({type:b.ADD_TO_USED_NAMES,payload:t})},onChange:function(e){return function(e,t){var a=e.target.value;return n({type:b.CHANGE_NAME_FROM_DELETED,id:t,payload:a})}(e,r)}})}),Object(c.jsxs)("p",{className:"oldCounterItem__item oldCounterItem__item--time text-white",children:[d," : ",l," : ",j]}),Object(c.jsx)("p",{className:"oldCounterItem__item oldCounterItem__item--action",onClick:function(){return function(e){return n({type:b.RESTORE_FROM_TABLE,id:e})}(r)},children:"\u2692"}),Object(c.jsx)("p",{className:"oldCounterItem__item oldCounterItem__item--action text-danger",onClick:function(){return function(e){return n({type:b.DELETE_FROM_TABLE,id:e})}(r)},children:"\xd7"})]})},T=a(86),g=function e(t){var a=t.name,n=t.data,r=Object(i.useState)(!1),s=Object(u.a)(r,2),o=s[0],d=s[1];return Object(c.jsxs)("div",{className:"bg-dark pt-1 pb-1 pl-3 pr-3",children:[Object(c.jsx)("div",{className:"text-white",onClick:function(e){e.stopPropagation(),d((function(e){return!e}))},children:a}),Object(c.jsx)(T.a,{isOpen:o,children:Object.keys(n).map((function(t){return n[t].isNode?Object(c.jsx)(h,{data:n[t]},t):Object(c.jsx)(e,{data:n[t],name:t},t)}))})]},a)},C=function(){var e=Object(i.useContext)(x),t=Object(u.a)(e,1)[0],a={};return t.oldCounters.ids.forEach((function(e){var n=new Date(+e),c=String(n.toLocaleString("default",{month:"long"})),r=String(n.getDate());a[c]||(a[c]={}),a[c][r]||(a[c][r]={}),a[c][r][e]=Object(o.a)(Object(o.a)({},t.oldCounters.data[e]),{},{id:e,isNode:!0})})),t.oldCounters.ids.length?Object(c.jsx)(v.a,{className:"overflow-auto",children:Object(c.jsx)(_.a,{className:"mb-5",children:Object.keys(a).map((function(e){return Object(c.jsx)(g,{data:a[e],name:e},e)}))})}):Object(c.jsx)(c.Fragment,{})},N=a(91),S=a(48),y=function(){var e=Object(i.useContext)(x),t=Object(u.a)(e,2),a=t[0],n=t[1];return Object(c.jsx)(v.a,{children:Object(c.jsx)(_.a,{children:Object(c.jsx)(S.a,{onClick:function(){return n({type:b.CREATE_COUNTER})},children:a.counters.ids.length?"\u0415\u0449\u0451 \u0441\u0447\u0451\u0442\u0447\u0438\u043a":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0447\u0451\u0442\u0447\u0438\u043a"})})})},A=a(51),D=a(28),M=a(27),I=function(e,t){var a;switch(t.type){case b.STOP:return e.counters.data[t.id].state===n.Playing&&clearInterval(e.counters.data[t.id].intervalId),Object(o.a)(Object(o.a)({},e),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(d.a)({},t.id,Object(o.a)(Object(o.a)({},e.counters.data[t.id]),{},{startTime:null,state:n.Pause,renderValue:O.renderValue,savedTime:O.savedTime})))})});case b.PLAY:if(e.mode===l.Single){var c={};return e.counters.ids.forEach((function(t){c[t]=Object(o.a)(Object(o.a)({},e.counters.data[t]),{},{state:n.Pause,startTime:null}),null!==c[t].intervalId&&(clearInterval(c[t].intervalId),c[t].intervalId=null)})),Object(o.a)(Object(o.a)({},e),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},c),{},Object(d.a)({},t.id,Object(o.a)(Object(o.a)({},e.counters.data[t.id]),{},{state:n.Playing,startTime:t.startTime})))})})}return Object(o.a)(Object(o.a)({},e),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(d.a)({},t.id,Object(o.a)(Object(o.a)({},e.counters.data[t.id]),{},{state:n.Playing,startTime:t.startTime})))})});case b.PAUSE:return clearInterval(e.counters.data[t.id].intervalId),Object(o.a)(Object(o.a)({},e),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(d.a)({},t.id,Object(o.a)(Object(o.a)({},e.counters.data[t.id]),{},{startTime:null,state:n.Pause,savedTime:E(e.counters.data[t.id].renderValue)})))})});case b.UPDATE_TIME:var r=function(e){var t=e.startTime,a=e.savedTime,n=+new Date,c=Math.floor((n-t)/1e3)+a;return f(c)}(e.counters.data[t.id]);return a=Object(o.a)(Object(o.a)({},e),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(d.a)({},t.id,Object(o.a)(Object(o.a)({},e.counters.data[t.id]),{},{renderValue:r})))})}),t.setStorageState(Object(o.a)(Object(o.a)({},a),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(d.a)({},t.id,Object(o.a)(Object(o.a)({},e.counters.data[t.id]),{},{renderValue:r,state:n.Pause,savedTime:E(e.counters.data[t.id].renderValue)+1})))})})),a;case b.SET_INTERVAL_ID:return a=Object(o.a)(Object(o.a)({},e),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(d.a)({},t.id,Object(o.a)(Object(o.a)({},e.counters.data[t.id]),{},{intervalId:t.intervalId})))})}),t.setStorageState(a),a;case b.CREATE_COUNTER:var s=String((new Date).getTime());return e.counters.ids.push(s),a=Object(o.a)(Object(o.a)({},e),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(d.a)({},s,Object(o.a)({},O)))})}),t.setStorageState(a),a;case b.DELETE_AND_MOVE_TO_TABLE:var u=e.counters.ids.filter((function(e){return e!==t.id})),i={},j=function(a){var n=t.id,c=a[n],r=Object(D.a)(a,[n].map(M.a)),s=null===c||void 0===c?void 0:c.renderValue,u=s.seconds,d=void 0===u?0:u,l=s.minutes,j=void 0===l?0:l,O=s.hours;return 0===d&&0===j&&0===(void 0===O?0:O)||(i=Object(o.a)({},c),e.oldCounters.ids.push(t.id)),r}(e.counters.data);return e.counters.data[t.id].intervalId&&clearInterval(e.counters.data[t.id].intervalId),a=Object(o.a)(Object(o.a)({},e),{},{oldCounters:Object(o.a)(Object(o.a)({},e.oldCounters),{},{data:Object(o.a)(Object(o.a)({},e.oldCounters.data),{},Object(d.a)({},t.id,i))}),counters:{ids:u,data:j}}),t.setStorageState(a),a;case b.CHANGE_NAME_FROM_EXIST:return a=Object(o.a)(Object(o.a)({},e),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(d.a)({},t.id,Object(o.a)(Object(o.a)({},e.counters.data[t.id]),{},{name:t.payload})))})}),t.setStorageState(a),a;case b.CHANGE_NAME_FROM_DELETED:return a=Object(o.a)(Object(o.a)({},e),{},{oldCounters:Object(o.a)(Object(o.a)({},e.oldCounters),{},{data:Object(o.a)(Object(o.a)({},e.oldCounters.data),{},Object(d.a)({},t.id,Object(o.a)(Object(o.a)({},e.oldCounters.data[t.id]),{},{name:t.payload})))})}),t.setStorageState(a),a;case b.DELETE_FROM_TABLE:var m=function(e){var a=t.id;e[a];return Object(D.a)(e,[a].map(M.a))}(e.oldCounters.data),x=e.oldCounters.ids.filter((function(e){return t.id!==e}));return a=Object(o.a)(Object(o.a)({},e),{},{oldCounters:{ids:x,data:m}}),t.setStorageState(a),a;case b.CHANGE_MODE:return t.mode!==e.mode?(a=Object(o.a)(Object(o.a)({},e),{},{mode:t.mode}),t.setStorageState(a),a):Object(o.a)({},e);case b.RESTORE_FROM_TABLE:var v=e.oldCounters.ids.filter((function(e){return e!==t.id})),_={},h=function(a){var n=t.id,c=a[n],r=Object(D.a)(a,[n].map(M.a));return _=Object(o.a)({},c),e.counters.ids.push(t.id),r}(e.oldCounters.data);return a=Object(o.a)(Object(o.a)({},e),{},{oldCounters:{ids:v,data:Object(o.a)({},h)},counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(d.a)({},t.id,_))})}),t.setStorageState(a),a;case b.ADD_TO_USED_NAMES:var T=t.payload.trim().toLowerCase();return T&&e.usedNames.every((function(e){return!~e.indexOf(T)}))?(a=Object(o.a)(Object(o.a)({},e),!e.usedNames.includes(T)&&{usedNames:[].concat(Object(A.a)(e.usedNames),[T])}),t.setStorageState(a),Object(o.a)({},a)):Object(o.a)({},e);case b.DELETE_FROM_USED_NAMES:return a=Object(o.a)(Object(o.a)({},e),{},{usedNames:e.usedNames.filter((function(e){return e!==t.payload}))}),t.setStorageState(a),Object(o.a)({},a);case b.CHANGE_TIME:return Object(o.a)(Object(o.a)({},e),{},{counters:Object(o.a)(Object(o.a)({},e.counters),{},{data:Object(o.a)(Object(o.a)({},e.counters.data),{},Object(d.a)({},t.id,Object(o.a)(Object(o.a)({},e.counters.data[t.id]),{},{renderValue:Object(o.a)(Object(o.a)({},e.counters.data[t.id].renderValue),{},Object(d.a)({},t.timeType,+t.payload)),savedTime:p(e.counters.data[t.id].renderValue,t.timeType,+t.payload)})))})});default:return Object(o.a)({},e)}},R=a(89),L=a(92),k=a(93),P=a(90),w=function(){var e=Object(i.useContext)(x),t=Object(u.a)(e,2),a=t[0],n=t[1],r=Object(i.useState)(!1),s=Object(u.a)(r,2),o=s[0],d=s[1];return Object(c.jsx)("div",{style:{position:"absolute",top:"10px",right:"15px"},children:Object(c.jsxs)(R.a,{isOpen:o,toggle:function(){return d((function(e){return!e}))},children:[Object(c.jsx)(L.a,{caret:!0,children:a.mode}),Object(c.jsxs)(k.a,{container:"body",children:[Object(c.jsx)(P.a,{onClick:function(){return n({type:b.CHANGE_MODE,mode:l.Single})},children:l.Single}),Object(c.jsx)(P.a,{onClick:function(){return n({type:b.CHANGE_MODE,mode:l.Multi})},children:l.Multi})]})]})})},F=(a(83),function(e){var t=e.currentInput,a=e.onClick,n=e.onDelete,r=Object(i.useContext)(x),s=Object(u.a)(r,1)[0];return Object(c.jsx)("div",{className:"inputHelper bg-white d-flex flex-column position-absolute",style:{top:"70px",zIndex:10},children:s.usedNames.filter((function(e){return~e.indexOf(t.toLowerCase())&&t!==e})).map((function(e){return Object(c.jsxs)("div",{className:"inputHelper__item",children:[Object(c.jsx)("p",{className:"inputHelper__text",onClick:function(t){t.stopPropagation(),a(e)},children:e}),Object(c.jsx)("div",{onClick:function(t){t.stopPropagation(),n(e)},className:"inputHelper__item-delete text-danger",children:"\xd7"})]},e)}))})}),V=function(e){var t=e.id,a=Object(i.useRef)(null),r=Object(i.useState)(""),s=Object(u.a)(r,2),o=s[0],d=s[1],l=Object(i.useState)(!1),j=Object(u.a)(l,2),O=j[0],m=j[1],E=Object(i.useContext)(x),f=Object(u.a)(E,2),p=f[0],v=f[1],_=Object(i.useState)(!1),h=Object(u.a)(_,2),T=h[0],g=h[1],C=function(){return p.counters.data[t].state===n.Playing},N=function(e){var a=e.target.value;T&&(m(Boolean(a)),d(a),v({type:b.CHANGE_NAME_FROM_EXIST,payload:a,id:t}))},y=function(e,a){T&&v({type:b.CHANGE_TIME,payload:e,timeType:a,id:t})},A=p.counters.data[t],D=A.renderValue,M=D.hours,I=D.minutes,R=D.seconds,L=A.name;return Object(c.jsxs)("div",{style:{border:"1px solid"},className:"d-flex flex-column position-relative pt-4 pb-4 bg-dark",children:[Object(c.jsx)("div",{className:"position-absolute text-danger",style:{top:"-5px",right:"5px",fontSize:"20px",cursor:"pointer"},onClick:function(){return v({type:b.DELETE_AND_MOVE_TO_TABLE,id:t})},children:"\xd7"}),Object(c.jsx)("div",{className:"position-absolute text-danger",style:{top:"5px",right:"25px",fontSize:"10px",cursor:"pointer"},onClick:function(){return g((function(e){return!e}))},children:"\u270e"}),Object(c.jsx)("input",{className:"mb-3 mt-3 align-self-center text-white bg-dark",style:{maxWidth:"60%",border:"transparent"},value:L,title:L,readOnly:!T,ref:a,onBlur:function(e){var t=e.target.value;setTimeout((function(){return m(!1)}),300),v({type:b.ADD_TO_USED_NAMES,payload:t})},onFocus:function(){return e=L,void(T&&(m(Boolean(e)),d(e)));var e},onChange:N}),O&&Object(c.jsx)(F,{currentInput:o,onClick:function(e){N({target:{value:e}}),a.current.focus()},onDelete:function(e){setTimeout((function(){a.current.focus(),m(!0)}),300),v({type:b.DELETE_FROM_USED_NAMES,payload:e})}}),Object(c.jsxs)("div",{className:"mb-5 justify-content-around d-flex text-white w-100",children:[Object(c.jsx)("input",{className:"text-white d-flex text-center text-white bg-dark",style:{border:"none",maxWidth:"15%"},value:M,onChange:function(e){var t=e.target.value;return y(t,"hours")}}),":",Object(c.jsx)("input",{className:"text-white d-flex text-center text-white bg-dark",style:{border:"none",maxWidth:"15%"},value:I,onChange:function(e){var t=e.target.value;return y(t,"minutes")}}),":",Object(c.jsx)("input",{className:"text-white d-flex text-center text-white bg-dark",style:{border:"none",maxWidth:"15%"},value:R,onChange:function(e){var t=e.target.value;return y(t,"seconds")}})]}),Object(c.jsxs)("div",{className:"justify-content-around d-flex",children:[Object(c.jsx)(S.a,{color:"success",onClick:function(){if(C())return v({type:b.PAUSE,id:t});v({type:b.PLAY,id:t,startTime:+new Date});var e=setInterval((function(){return v({type:b.UPDATE_TIME,id:t})}),1e3);v({type:b.SET_INTERVAL_ID,intervalId:e,id:t})},style:{flexBasis:"40%"},children:C()?"\u041f\u0430\u0443\u0437\u0430":0===R?"\u0421\u0442\u0430\u0440\u0442":"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c"}),!C()&&Object(c.jsx)(S.a,{color:"success",style:{flexBasis:"40%"},onClick:function(){return v({type:b.STOP,id:t})},children:"\u0421\u0442\u043e\u043f"})]})]})},H=function(){var e=Object(i.useContext)(x),t=Object(u.a)(e,1)[0];return Object(c.jsx)(v.a,{className:"mb-4",children:t.counters.ids.map((function(e){return Object(c.jsx)(_.a,{md:4,className:"mb-4",children:Object(c.jsx)(V,{id:e})},e)}))},"counters")},U=function(){var e=function(e){var t=e.keys,a=e.initialState,n=void 0===a?{}:a,c={};Object.keys(n).forEach((function(e){return localStorage.setItem(e,JSON.stringify(n[e]))})),t.forEach((function(e){var t=JSON.parse(localStorage.getItem(e));["counters","oldCounters"].includes(e)&&t.ids.forEach((function(e){t.data[e].value&&(t.data[e]=Object(o.a)(Object(o.a)({},t.data[e]),{},{renderValue:Object(o.a)({},t.data[e].value)}),delete t.data[e].value)})),null!==t&&void 0!==t&&(c[e]=t)}));var r=Object(i.useState)(c),s=Object(u.a)(r,2),d=s[0],l=s[1];return[d,function(e){var a;a="function"===typeof e?Object(o.a)(Object(o.a)({},d),e(d)):Object(o.a)(Object(o.a)({},d),e),t.forEach((function(e){return localStorage.setItem(e,JSON.stringify(a[e]))})),l(a)}]}({keys:Object.keys(m)}),t=Object(u.a)(e,2),a=t[0],n=t[1],r=Object(i.useReducer)(I,Object(o.a)(Object(o.a)({},m),a)),s=Object(u.a)(r,2),d=s[0],l=s[1];return Object(c.jsx)(x.Provider,{value:[d,function(e){return l(Object(o.a)(Object(o.a)({},e),{},{setStorageState:n}))}],children:Object(c.jsxs)(N.a,{fluid:!0,className:"bg-primary",style:{minHeight:"100vh",padding:"70px 3rem 20px"},children:[Object(c.jsx)(w,{}),Object(c.jsx)(C,{},"oldCounters"),Object(c.jsx)(H,{}),Object(c.jsx)(y,{},"createCounter")]})})};a(84);s.a.render(Object(c.jsx)(U,{}),document.querySelector("#root"))}},[[85,1,2]]]);
//# sourceMappingURL=main.b3271cef.chunk.js.map